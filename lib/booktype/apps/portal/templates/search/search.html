{% extends '/core/base.html' %}
{% load i18n staticfiles profile messaging_tags reader_tags %}

{% block content %}
<!-- Bookbar -->
<div class="bookbar">
  <h1>Haku</h1>
</div>
<!-- end Bookbar -->

    <div class="container groupsettings">
        <div class="row two-col">
            <div class="col-xs-8">
                <div class="box gray">

                <h2 class="box-title">Haku</h2>
<p>Haku kirjojen sisällöstä</p>
<div style="padding:20px;">
    <form class="search" role="search" method="get" action="http://fi.flossmanuals.net/search/">
      <div class="search">
        {% if query %}
        <input class="search" type="text" name="q" placeholder="{{ query }}"/>
	{% else %}
        <input class="search" type="text" name="q" placeholder="Hae"/>
	{% endif %}
        <button class="search" type="submit">Haku</button>
      </div>
    </form>
</div>

            {% if query %}

            <h3>Tulokset haulle {{ query }}</h3>

	    {{ page|dictsort:"modified" }}


	    {% for result in page.object_list|dictsort:"title" %}
	    {{ result }}
            {% if result.object.book.hidden %}
            {% else %}

		<p>Kirjan {{ result.object.book.title }} luku {{ result.object.title }}</p>
                <p>Muokattu viimeksi {{ result.object.modified }}</p>
         
		<p>{{ result.object.version }}</p>
		<div style="opacity:0.5;">{{ result.object.content|safe }}</div>
                <p>
                    <a href="http://fi.flossmanuals.net/{{ result.object.book.url_title }}/_draft/{{ result.object.url_title }}/">{{ result.object.title }}</a>
                </p>

	    {% endif %}
            {% empty %}
                Ei tuloksia haulla {{ query }}!
            {% endfor %}

            {% if page.has_previous or page.has_next %}
                <div>
                    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                    |
                    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
    </form>
    </div>
</div>
    </div>
</div>

{% endblock %}
